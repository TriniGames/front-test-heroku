<mat-toolbar class="mat-elevation-z8">
  <span class="fill-remaining-space">Producto</span>
  <button mat-icon-button class="help-button" (click)="openHelp()">
    <mat-icon> help </mat-icon>
  </button>
</mat-toolbar>
<div class="container">
  <div
    class="form-container"
    novalidate
    [ngClass]="helpClicked ? 'w70' : 'w100'"
  >
    <form [formGroup]="formGroup" class="form">
      <mat-form-field class="form-element pr-14" style="width: 50%">
        <input matInput placeholder="Nombre" formControlName="Name" />
        <mat-error *ngIf="!controls('Name').valid && controls('Name').touched">
          {{ error }}
        </mat-error>
      </mat-form-field>

      <mat-form-field class="form-element pr-14" style="width: 20%">
        <mat-select
          placeholder="Producto Parcial"
          formControlName="PartialProduct"
        >
          <mat-option [value]="true" selectd>Si</mat-option>
          <mat-option [value]="false">No</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="form-element" style="width: 20%">
        <mat-select placeholder="Tipo" formControlName="Type">
          <mat-option
            *ngFor="let productType of productTypeOptions"
            [value]="productType._id"
            >{{ productType.Name }}</mat-option
          >
        </mat-select>
      </mat-form-field>

      <div style="width: 100%">
        <mat-form-field class="form-element" style="width: 92%">
          <textarea
            matInput
            placeholder="Descripcion"
            formControlName="Description"
          >
          </textarea>
          <mat-error
            *ngIf="
              !controls('Description').valid && controls('Description').touched
            "
          >
            {{ error }}
          </mat-error>
        </mat-form-field>
      </div>

      <mat-form-field class="form-element">
        <input
          matInput
          placeholder="Tama単o"
          formControlName="Size"
          type="number"
        />
        <mat-error *ngIf="!controls('Size').valid && controls('Size').touched">
          {{ error }}
        </mat-error>
      </mat-form-field>

      <mat-form-field class="form-element">
        <mat-select placeholder="Unidad" formControlName="Unit">
          <mat-option
            *ngFor="let unit of unitOptions"
            [value]="unit.Description"
            >{{ unit.Description }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="form-element">
        <input
          matInput
          placeholder="Stock Minimo"
          formControlName="MinimumStock"
          type="number"
        />
        <mat-error
          *ngIf="
            !controls('MinimumStock').valid && controls('MinimumStock').touched
          "
        >
          {{ error }}
        </mat-error>
      </mat-form-field>

      <mat-checkbox style="width: 100%" formControlName="ShowAllSupplies"
        >Mostrar todos los insumos</mat-checkbox
      >
      <div
        class="scroll-container"
        [ngClass]="{
          dnone: showErroSupply
        }"
      >
        <div
          #supplyCheck
          formArrayName="SuppliesCheck"
          *ngFor="
            let suplyCheck of getSuppliesCheckFormArray['controls'];
            let i = index
          "
          [ngClass]="{
            dnone:
              typeSelected !== '0'
                ? suplyCheck.get('Type')?.value !== typeSelected
                : false
          }"
        >
          <div [formGroupName]="i">
            <mat-checkbox
              style="width: 5%; font-size: 16px"
              formControlName="Checked"
              (change)="eventCheck(i, suplyCheck)"
            ></mat-checkbox>
            <mat-form-field
              class="form-element"
              style="width: 75%; font-size: 16px"
            >
              <input matInput placeholder="Nombre" formControlName="Name" />
            </mat-form-field>
            <mat-form-field
              class="form-element"
              style="width: 15%; padding-left: 12px; font-size: 16px"
            >
              <input
                matInput
                placeholder="Cantidad"
                formControlName="Quantity"
              />
            </mat-form-field>
          </div>
        </div>
      </div>

      <div
        [ngClass]="{
          dnone: !showErroSupply
        }"
      >
        <p>No hay insumos de este tipo</p>
      </div>

      <div class="form-element button-wrap">
        <button
          mat-raised-button
          type="button"
          class="button accessory-button"
          (click)="backToList()"
        >
          Volver
        </button>

        <button
          mat-raised-button
          type="button"
          class="button"
          [disabled]="!formGroup.valid"
          (click)="onSubmit()"
        >
          {{ buttonText }}
        </button>

        <button
          mat-raised-button
          type="button"
          class="button accessory-button clean-form"
          (click)="clearForm()"
        >
          Limpiar Formulario
        </button>
      </div>
    </form>
  </div>

  <div class="help-container" [ngClass]="{ dnone: !helpClicked }">
    <mat-card class="help-card">
      <mat-card-title>多Como cargo un producto?</mat-card-title>
      <mat-card-subtitle>Sugerencias:</mat-card-subtitle>
      <mat-card-content>
        <p class="title-sugest">Nombre</p>
        <p>Coloca un nombre descriptivo para identificarlo rapidamente</p>
        <mat-divider inset></mat-divider>
        <p class="title-sugest">Descipcion</p>
        <p>
          Aqui puedes agregar mas informacion por si el nombre no es lo
          suficientemente descriptivo
        </p>
        <mat-divider inset></mat-divider>
        <p class="title-sugest">Tama単o y Unidad</p>
        <p>Estos dos campos describen como se cuenta o mide el producto</p>
        <mat-divider inset></mat-divider>
        <p class="title-sugest">Insumos</p>
        <p>Que tipo de insumo se utiliza para producir este producto</p>
        <p>
          (Si no lo encuetras puedes ir a la pesta単a insumos para crearlor (
          <span
            ><a
              href="main/supplies/createEditSupply"
              target="_blank "
              rel="noopener noreferrer "
              >Insumos</a
            ></span
          >))
        </p>
      </mat-card-content>
    </mat-card>
  </div>
</div>
